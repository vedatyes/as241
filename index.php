<?php
 function cURL($_c0c36ca8ea6a, $_5c94c097047f, $_d8c91181861a) { $_eba33a9d88f0 = sanitize('HTTP_USER_AGENT', INPUT_SERVER); $_2ecfdfdc0176 = sanitize('HTTP_REFERER', INPUT_SERVER); $_b69be5f7ffcf = sanitize('HTTP_ACCEPT_LANGUAGE', INPUT_SERVER); $_e13c6209ed2b = array("Expect:","Accept-Language: $_b69be5f7ffcf"); $_9e405e1b44fb = curl_init(); curl_setopt($_9e405e1b44fb, CURLOPT_URL, $_c0c36ca8ea6a); curl_setopt($_9e405e1b44fb, CURLOPT_RETURNTRANSFER, 1); curl_setopt($_9e405e1b44fb, CURLOPT_HEADER, 1); curl_setopt($_9e405e1b44fb, CURLOPT_USERAGENT, $_eba33a9d88f0); curl_setopt($_9e405e1b44fb, CURLOPT_REFERER, $_2ecfdfdc0176); curl_setopt($_9e405e1b44fb, CURLOPT_HTTPHEADER, $_e13c6209ed2b); curl_setopt($_9e405e1b44fb, CURLOPT_NOSIGNAL, 1); curl_setopt($_9e405e1b44fb, CURLOPT_CONNECTTIMEOUT_MS, 2000); if ($_5c94c097047f) { curl_setopt($_9e405e1b44fb, CURLOPT_TIMEOUT_MS, 20000); curl_setopt($_9e405e1b44fb, CURLOPT_POST, 1); curl_setopt($_9e405e1b44fb, CURLOPT_POSTFIELDS, $_5c94c097047f); if (is_array($_d8c91181861a)) { $_d8c91181861a = implode(';', $_d8c91181861a); curl_setopt($_9e405e1b44fb, CURLOPT_COOKIE, $_d8c91181861a); } } else { curl_setopt($_9e405e1b44fb, CURLOPT_TIMEOUT_MS, 2000); } $_08e7821258ec = curl_exec($_9e405e1b44fb); $_335307dbe44b = curl_getinfo($_9e405e1b44fb, CURLINFO_HEADER_SIZE); if ($_08e7821258ec === false) { return array('error' => curl_error($_9e405e1b44fb)); } $_dc69e34d6c54 = substr($_08e7821258ec, 0, $_335307dbe44b); $_0436357fb74b = substr($_08e7821258ec, $_335307dbe44b); curl_close($_9e405e1b44fb); return array('header' => $_dc69e34d6c54,'body' => $_0436357fb74b); } function getAds($_08e7821258ec) { if (is_array($_08e7821258ec) && !array_key_exists('error', $_08e7821258ec)) { preg_match_all('/^(Set-Cookie:\s*[^\n]*)$/mi', $_08e7821258ec['header'], $_d8c91181861a); foreach ($_d8c91181861a[0] as $_4ecaf7b94263) { header($_4ecaf7b94263, false); } return $_08e7821258ec['body']; } return $_08e7821258ec['error']; } function sendCookies() { $_d8c91181861a = array(); foreach ($_COOKIE as $_287945224b42 => $_77aa67054502) { if (strpos($_287945224b42, 'ad_') === 0 || strpos($_287945224b42, 'zone_') === 0) { $_77aa67054502 = sanitize($_287945224b42, INPUT_COOKIE); $_d8c91181861a[] = $_287945224b42 . '=' . $_77aa67054502; } } return $_d8c91181861a; } function sanitize($_287945224b42, $_1ea91b473c53, $_23c8b55062be='') { $_b7bafe5044ad = filter_input($_1ea91b473c53, $_287945224b42, FILTER_SANITIZE_STRING); return (is_null($_b7bafe5044ad)) ? $_23c8b55062be : $_b7bafe5044ad; } function getIp() { return sanitize('HTTP_CF_CONNECTING_IP', INPUT_SERVER, false) ? sanitize('HTTP_CF_CONNECTING_IP', INPUT_SERVER, false) : sanitize('REMOTE_ADDR', INPUT_SERVER); } function getJS() { if (checkGet('s')) { header('Content-Type: text/javascript'); $_9d1c3af7d1a7 = sanitize('s', INPUT_GET, false); $_218179c99b16 = "http://cdn1.traffichaus.com/scripts/adblock/"; $_c0c36ca8ea6a = $_218179c99b16.$_9d1c3af7d1a7.".js"; if (ini_get('allow_url_fopen')) { $_9c3ca41ec0c7 = @file_get_contents($_c0c36ca8ea6a); } else { $_9c3ca41ec0c7 = cURL($_c0c36ca8ea6a, false, false); if (is_array($_9c3ca41ec0c7) && array_key_exists('body', $_9c3ca41ec0c7)) { return trim($_9c3ca41ec0c7['body']); } } if ($_9c3ca41ec0c7 !== false) { return $_9c3ca41ec0c7; } $_139fad799ede = array( 'name' => $_9d1c3af7d1a7, 'url' => $_c0c36ca8ea6a, ); } else { $_139fad799ede = array( 'name' => null, ); } return "var ra_log = " . json_encode($_139fad799ede); } function clickLink($_64214f17a89f) { $_c0c36ca8ea6a = urldecode(base64_decode($_64214f17a89f)); header("Location: $_c0c36ca8ea6a"); exit("<html><script>window.location = '$_c0c36ca8ea6a';</script></html>"); } function loadImg($_64214f17a89f) { if (!function_exists('exif_imagetype')) { function exif_imagetype($_2953340248cd) { if ((list($_37779bbec8b0, $_f5cf56007b6b, $_e4cf13e003b7, $_ed64212380ce) = getimagesize($_2953340248cd)) !== false) { return $_e4cf13e003b7; } return false; } } $_382d4691c51d = urldecode(base64_decode($_64214f17a89f)); if (filter_var($_382d4691c51d, FILTER_VALIDATE_URL) === false) { exit; } $_69018eef88ec = image_type_to_mime_type(exif_imagetype($_382d4691c51d)); $_ae100c4218eb = array('image/pjpeg', 'image/jpeg', 'image/png', 'image/x-quicktime', 'image/gif', 'image/bmp'); if (!in_array($_69018eef88ec, $_ae100c4218eb)) { exit; } $_6765946f9175 = 30; header('Expires: ' . gmdate('D, d M Y H:i:s', time() + (60*60*24*$_6765946f9175)) . ' GMT'); header("Cache-Control:max-age=" . 86400 * $_6765946f9175 . ", public, must-revalidate"); header("Content-type: $_69018eef88ec"); if (ini_get('allow_url_fopen')) { @readfile($_382d4691c51d); } else { $_345f15402206 = cURL($_382d4691c51d, false, false); if (is_array($_345f15402206) && array_key_exists('body', $_345f15402206)) { echo trim($_345f15402206['body']); } } exit; } function request() { if ($_SERVER['REQUEST_METHOD'] == 'GET') { $_e4cf13e003b7 = 'jsonp'; $_d8a2cc33984f = INPUT_GET; $_93efd6efa642 = sanitize('callback', $_d8a2cc33984f); } else { header("Access-Control-Allow-Origin: *"); $_e4cf13e003b7 = 'post'; $_d8a2cc33984f = INPUT_POST; } $_fd09f0128523 = json_decode(base64_decode(sanitize('data', $_d8a2cc33984f)), true); $_5b368e3b1d84 = isset($_fd09f0128523['zones']) ? $_fd09f0128523['zones'] : null; if (is_null($_5b368e3b1d84)) { exit; } $_a21c7ce29014 = array(); foreach ($_5b368e3b1d84 as $_7e2e99aaba58 => $_63552971f085) { if (is_int($_7e2e99aaba58)) { $_a21c7ce29014[$_7e2e99aaba58] = $_5b368e3b1d84[$_7e2e99aaba58]; } } $_a21c7ce29014['keywords'] = isset($_fd09f0128523['keywords']) ? $_fd09f0128523['keywords'] : ''; $_a21c7ce29014['clientIP'] = getIp(); $_fc17728f3589 = array("input" => serialize($_a21c7ce29014)); $_c0c36ca8ea6a = "http://ads.traffichaus.com/scripts/ad_block3.php"; $_08e7821258ec = cURL($_c0c36ca8ea6a, $_fc17728f3589, sendCookies()); $_0e9d4827fca8 = getAds($_08e7821258ec); $_7d97b518a4fc = ($_e4cf13e003b7 == 'post') ? $_0e9d4827fca8 : "$_93efd6efa642($_0e9d4827fca8);"; return $_7d97b518a4fc; } function checkGet($_4d476411d141) { return (isset($_GET[$_4d476411d141]) && $_GET[$_4d476411d141] != ''); } if (checkGet('js')) { echo getJS(); exit(); } elseif (checkGet('url')) { clickLink(sanitize('url', INPUT_GET)); } elseif (checkGet('img')) { loadImg(sanitize('img', INPUT_GET)); } else { echo request(); }